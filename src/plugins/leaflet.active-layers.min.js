L.Control.ActiveLayers=L.Control.Layers.extend({getActiveBaseLayer:function(){return this._activeBaseLayer},getActiveOverlayLayers:function(){return this._activeOverlayLayers},onAdd:function(e){var a=L.Control.Layers.prototype.onAdd.call(this,e);return Array.isArray(this._layers)?(this._activeBaseLayer=this._findActiveBaseLayer(),this._activeOverlayLayers=this._findActiveOverlayLayers()):(this._activeBaseLayer=this._findActiveBaseLayerLegacy(),this._activeOverlayLayers=this._findActiveOverlayLayersLegacy()),a},_findActiveBaseLayer:function(){for(var e=this._layers,a=0;a<e.length;a++){var r=e[a];if(!r.overlay&&this._map.hasLayer(r.layer))return r}throw new Error("Control doesn't have any active base layer!")},_findActiveOverlayLayers:function(){for(var e={},a=this._layers,r=0;r<a.length;r++){var t=a[r];t.overlay&&this._map.hasLayer(t.layer)&&(e[t.layer._leaflet_id]=t)}return e},_findActiveBaseLayerLegacy:function(){var e=this._layers;for(var a in e)if(this._layers.hasOwnProperty(a)){var r=e[a];if(!r.overlay&&this._map.hasLayer(r.layer))return r}throw new Error("Control doesn't have any active base layer!")},_findActiveOverlayLayersLegacy:function(){var e={},a=this._layers;for(var r in a)if(this._layers.hasOwnProperty(r)){var t=a[r];t.overlay&&this._map.hasLayer(t.layer)&&(e[r]=t)}return e},_onLayerChange:function(){L.Control.Layers.prototype._onLayerChange.apply(this,arguments),this._recountLayers()},_onInputClick:function(){this._handlingClick=!0,this._recountLayers(),L.Control.Layers.prototype._onInputClick.call(this),this._handlingClick=!1},_recountLayers:function(){var e,a,r,t,i;for(i=(t=this.hasOwnProperty("_section")?this._section.getElementsByTagName("input"):this._form.getElementsByTagName("input")).length,e=0;e<i;e++)a=t[e],r=Array.isArray(this._layers)?this._layers[e]:this._layers[a.layerId],a.checked&&!this._map.hasLayer(r.layer)?r.overlay?this._activeOverlayLayers[a.layerId]=r:this._activeBaseLayer=r:!a.checked&&this._map.hasLayer(r.layer)&&r.overlay&&delete this._activeOverlayLayers[a.layerId]}}),L.control.activeLayers=function(e,a,r){return new L.Control.ActiveLayers(e,a,r)};